<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Chat — Emotion Art</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-slate-900 text-white flex flex-col">

  <header class="p-4 border-b border-slate-700 flex items-center gap-3">
    <div class="w-10 h-10 rounded-lg bg-indigo-500 flex items-center justify-center font-bold">EA</div>
    <div class="font-semibold text-lg">Emotion Art Chat</div>
  </header>

  <main id="chatArea" class="flex-1 overflow-auto p-4 space-y-4"></main>

  <form id="composer" class="p-4 border-t border-slate-700 bg-slate-800 flex gap-3">
    <input id="inputText" class="flex-1 p-3 rounded-xl bg-slate-700 border border-slate-600 placeholder:text-slate-400" placeholder="Type your feeling..." />
    <button type="submit" class="px-4 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500">Send</button>
  </form>

<script>

  const chatArea = document.getElementById('chatArea');
  const composer = document.getElementById('composer');
  const inputText = document.getElementById('inputText');

  // Local emotion → image mapping (NO server)
  const IMG = {
    happy: "/static/art/happy.png",
    sadness: "/static/art/sad.png",
    anger: "/static/art/angry.png",
    fear: "/static/art/fear.png",
    love: "/static/art/love.png",
    surprise: "/static/art/surprise.png",
    disgust: "/static/art/disgust.png",
    neutral: "/static/art/calm.png"
  };

  // Pure client-side emotion detection
  function detectEmotion(text) {
    text = text.toLowerCase();

    if (/sad|cry|depress|upset/.test(text)) return "sadness";
    if (/happy|joy|glad|excited|yay/.test(text)) return "happy";
    if (/angry|mad|furious|hate/.test(text)) return "anger";
    if (/fear|scared|afraid|nervous/.test(text)) return "fear";
    if (/love|heart|romantic/.test(text)) return "love";
    if (/surpris|wow|shocked|omg/.test(text)) return "surprise";
    if (/disgust|gross|yuck/.test(text)) return "disgust";

    return "neutral";
  }

  function bubble(text, who="me") {
    const wrap = document.createElement("div");
    wrap.className = who === "me" ? "flex justify-end" : "flex justify-start";

    const box = document.createElement("div");
    box.className = 
      who === "me" 
      ? "bg-indigo-600 text-white p-3 rounded-2xl max-w-[80%]" 
      : "bg-slate-700 p-3 rounded-2xl max-w-[80%]";

    box.textContent = text;
    wrap.appendChild(box);
    chatArea.appendChild(wrap);
    chatArea.scrollTop = chatArea.scrollHeight;
  }

  function bubbleImage(url) {
    const wrap = document.createElement("div");
    wrap.className = "flex justify-start";

    const img = document.createElement("img");
    img.src = url;
    img.className = "mt-3 w-64 rounded-xl shadow-lg";

    wrap.appendChild(img);
    chatArea.appendChild(wrap);
    chatArea.scrollTop = chatArea.scrollHeight;
  }

  composer.addEventListener("submit", (e) => {
    e.preventDefault();

    const text = inputText.value.trim();
    if (!text) return;

    // Show your message
    bubble(text, "me");

    // Detect emotion locally
    const emo = detectEmotion(text);
    const img = IMG[emo] || IMG["neutral"];

    // Show only the image (NO SERVER, NO ERROR TEXT)
    bubbleImage(img);

    inputText.value = "";
  });

</script>
</body>
</html>
